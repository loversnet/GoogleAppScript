function CreatePDF() {
  var ssid = "【スプレッドシートのURL】";
  
    var objSpreadsheet = SpreadsheetApp.getActiveSpreadsheet();
	// スプレッドシート
  var datass = objSpreadsheet.getSheetByName("フォームの回答");
  var pdfss = objSpreadsheet.getSheetByName("PDFフォーム");
  var request_date = Utilities.formatDate(new Date(),"Asia/Tokyo","YYYY-MM-dd");
  
  
	// 選択セル範囲
	var range = datass.getActiveRange();
	// セル範囲の行番号
  var rowIndex = range.getRowIndex();
	// セル範囲の列番号
	var colIndex = range.getColumnIndex();

    
    var arydata = datass.getRange(rowIndex, 1, 1, 21).getValues(); 


 Logger.log(arydata);
  var DocumentNumber = String(rowIndex-1); //アンケートの採番用にインデックス行を除いて1から管理番号として設定します。"2019" + String(lastrow-1)としたり、応用の幅があります。

  var data = arydata[0];

    Logger.log(data[3]);

   var name = data[1]; 
   
    
  pdfss.getRange("B1").setValue(DocumentNumber);
  pdfss.getRange("B4").setValue(data[1]); //項目１
  pdfss.getRange("B8").setValue(data[3]); //項目２
  pdfss.getRange("B12").setValue(data[4]); //項目３
  pdfss.getRange("B16").setValue(data[5]); //項目４
  pdfss.getRange("B20").setValue(data[6]); //項目５
  pdfss.getRange("B24").setValue(data[7]); //項目６
  pdfss.getRange("B28").setValue(data[8]); //項目７
  pdfss.getRange("B32").setValue(data[9]); //項目８
  pdfss.getRange("B36").setValue(data[10]); //項目９
  pdfss.getRange("B40").setValue(data[11]); //項目10
  pdfss.getRange("B44").setValue(data[12]); //項目11
  pdfss.getRange("B48").setValue(data[13]); //項目12
  
  //作成したシートのコピー作成
    var copysheet = pdfss.copyTo(objSpreadsheet).setName(request_date + "_" + name + "_" + DocumentNumber); 
  
  copysheet.activate();
   objSpreadsheet.moveActiveSheet(3);
  
//コピーしたシートid取得  
  var pdfsheetid = copysheet.getSheetId();  
  
  //以下PDF化のためのプログラムです。今回はA4サイズでPDF化するため、オプション設定も下記のようになります。
  var url = "https://docs.google.com/spreadsheets/d/SSID/export?".replace("SSID", ssid);
  var url_ext = [];

  var opts = {
    format: "pdf",
    size: "A4",
    fzr: "false",
    portrait: "true",
    gridlines: "false",
    printtitle: "false",
    pagenumbers: "false",
    fitw: "true",
    sheetnames: "false",
    gid: pdfsheetid
  };

  // 上記のoptsのオプション名と値を「=」で繋げて配列url_extに格納
  for (optName in opts) {
    url_ext.push(optName + "=" + opts[optName]);
  }

  // url_extの各要素を「&」で繋げる
  var options = url_ext.join("&");
  Logger.log(options)

  try {
    // API使用のためのOAuth認証
    var token = ScriptApp.getOAuthToken();

    var response = UrlFetchApp.fetch(url + options, {
      headers: {
        "Authorization": "Bearer " + token
      }
    });

    // ファイル名を作成「応募日時_名前_管理番号.pdf」（自由に決められます）
    var fileName = request_date + "_" + name + "_" + DocumentNumber + ".pdf";
    // Googleドライブでフォルダを作成してURLからIDを入力
    var folder = DriveApp.getFolderById("【PDF化したものを格納するフォルダのURL】");
    var fileBlob = response.getBlob().setName(fileName);

    Logger.log(fileName);
    
    folder.createFile(fileBlob);


  } catch (e) {
    Logger.log("ファイル生成に失敗しました" + e)
  }
}
